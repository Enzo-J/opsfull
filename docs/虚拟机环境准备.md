# 一、安装环境准备

下载系统镜像:可以在阿里云镜像站点下载 CentOS 

镜像: http://mirrors.aliyun.com/centos/7/isos/x86_64/CentOS-7-x86_64-DVD-1804.iso

创建虚拟机:步骤略。

# 二、操作系统安装
 为了统一环境，保证实验的通用性，将网卡名称设置为 eth*，不使用 CentOS 7 默认的网卡命名规则。所以需要在安装的时候，增加内核参数。
 
 ## 1)光标选择“Install CentOS 7”
 
  ![](https://github.com/Lancger/opsfull/blob/master/images/install%20centos7.png)

 ## 2)点击 Tab，打开 kernel 启动选项后，增加 net.ifnames=0 biosdevname=0，如下图所示。
 
  ![](https://github.com/Lancger/opsfull/blob/master/images/change%20network.png)

# 三、设置网络

## 1.vmware-workstation设置网络。

如果你的默认 NAT 地址段不是 192.168.56.0/24 可以修改 VMware Workstation 的配置，点击编辑 -> 虚拟 网络配置，然后进行配置。

  ![](https://github.com/Lancger/opsfull/blob/master/images/vmware-network.png)

## 2.virtualbox设置网络。

  ![eth0](https://github.com/Lancger/opsfull/blob/master/images/virtualbox-network-eth0.jpg)
  
  ![eth1](https://github.com/Lancger/opsfull/blob/master/images/virtualbox-network-eth1.png)

# 四、系统配置

## 1.设置主机名
```
[root@localhost ~]# vi /etc/hostname 
linux-node1.example.com

###修改本机hostname###
[root@localhost ~]# hostnamectl set-hostname linux-node1.example.com
```

## 2.设置 IP 地址
  
  请配置静态 IP 地址。注意将 UUID 和 MAC 地址已经其它配置删除掉，便于进行虚 拟机克隆，请参考下面的配置。
```
[root@localhost ~]# vim /etc/sysconfig/network-scripts/ifcfg-eth0 
TYPE=Ethernet
BOOTPROTO=static 
NAME=eth0 
DEVICE=eth0 
ONBOOT=yes 
IPADDR=192.168.56.11 
NETMASK=255.255.255.0 
#GATEWAY=192.168.56.2

#重启网络服务
[root@localhost ~]# systemctl restart network

```

## 3.关闭 NetworkManager 和防火墙开启自启动
```
[root@linux-node1 ~]# systemctl disable firewalld 
[root@linux-node1 ~]# systemctl disable NetworkManager
```

## 4.设置主机名解析
```
[root@linux-node1 ~]# cat /etc/hosts
127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6 
192.168.56.11 linux-node1 linux-node1.example.com
192.168.56.12 linux-node2 linux-node2.example.com
```
## 5.关闭并确认 SELinux 处于关闭状态
```
[root@linux-node1 ~]# vim /etc/sysconfig/selinux 
SELINUX=disabled #修改为 disabled

#关闭selinux
[root@linux-node1 ~]# sed -i "s/SELINUX=enforcing/SELINUX=disabled/g" /etc/sysconfig/selinux
[root@linux-node1 ~]# sed -i "s/SELINUXTYPE=targeted/SELINUXTYPE=disabled/g" /etc/sysconfig/selinux

[root@linux-node1 ~]# setenforce 0 #使配置立即生效
```
## 6.时间同步
```
#为了保证各服务器间时间一致，使用ntpdate同步时间。
# 安装ntpdate
yum install -y wget lrzsz vim net-tools openssh-clients ntpdate unzip xz

$ 加入crontab
1 * * * *  (/usr/sbin/ntpdate -s ntp1.aliyun.com;/usr/sbin/hwclock -w) > /dev/null 2>&1
1 * * * * /usr/sbin/ntpdate ntp1.aliyun.com >/dev/null 2>&1

#设置时区
$ cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
```
## 7.其他配置
```
#SSH登录慢
sed -i "s/#UseDNS yes/UseDNS no/"  /etc/ssh/sshd_config
sed -i "s/GSSAPIAuthentication yes/GSSAPIAuthentication no/"  /etc/ssh/sshd_config
systemctl restart sshd.service

###Centos7禁用ipv6###
#vim /etc/sysctl.conf 
net.ipv6.conf.all.disable_ipv6=1

echo "net.ipv6.conf.all.disable_ipv6=1" >> /etc/sysctl.conf 

sysctl -p
```
